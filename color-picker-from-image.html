<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Picker from Image | ToolStackX</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --success: #2ecc71;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2d5a8c, #3498db);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: var(--light);
        }
        
        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-app {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .image-section, .color-info-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h2 i {
            font-size: 1.5rem;
        }
        
        .upload-area {
            border: 3px dashed rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .upload-area:hover {
            border-color: var(--secondary);
            background: rgba(52, 152, 219, 0.1);
        }
        
        .upload-area.dragover {
            border-color: var(--success);
            background: rgba(46, 204, 113, 0.1);
        }
        
        .upload-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .image-container {
            position: relative;
            width: 100%;
            max-height: 400px;
            overflow: hidden;
            border-radius: 10px;
            display: none;
        }
        
        #imageCanvas {
            width: 100%;
            height: auto;
            cursor: crosshair;
            border-radius: 10px;
        }
        
        .magnifier {
            position: absolute;
            width: 100px;
            height: 100px;
            border: 2px solid white;
            border-radius: 50%;
            overflow: hidden;
            pointer-events: none;
            display: none;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .magnifier canvas {
            width: 100%;
            height: 100%;
        }
        
        .color-display {
            width: 100%;
            height: 150px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .color-values {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .color-value-group {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
        }
        
        .color-value-group h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--secondary);
        }
        
        .color-value {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .color-value input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-family: 'Courier New', monospace;
        }
        
        .color-value button {
            padding: 10px 15px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .color-value button:hover {
            background: #2980b9;
        }
        
        .color-palette {
            margin-top: 20px;
        }
        
        .palette-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--secondary);
        }
        
        .palette-colors {
            display: flex;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .palette-color {
            flex: 1;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .palette-color:hover {
            transform: scale(1.05);
            z-index: 2;
        }
        
        .palette-color span {
            position: absolute;
            bottom: 5px;
            left: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.7rem;
            text-align: center;
        }
        
        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .reset-btn {
            background: var(--accent);
            color: white;
        }
        
        .generate-btn {
            background: var(--success);
            color: white;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .recent-colors {
            margin-top: 30px;
        }
        
        .recent-colors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .recent-color {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .recent-color:hover {
            transform: scale(1.1);
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .feature-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--secondary);
        }
        
        .feature-card h3 {
            font-size: 1.4rem;
            margin-bottom: 10px;
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 25px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
        }
        
        @media (max-width: 768px) {
            .main-app {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .color-values {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Color Picker from Image</h1>
            <p class="tagline">Upload an image and pick colors directly from it with pixel-perfect precision</p>
        </header>
        
        <div class="main-app">
            <div class="image-section">
                <h2><i>üñºÔ∏è</i> Image Upload</h2>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">üìÅ</div>
                    <h3>Drag & Drop Image Here</h3>
                    <p>or click to browse files</p>
                    <p style="font-size: 0.9rem; opacity: 0.8; margin-top: 10px;">Supports JPG, PNG, GIF, WebP</p>
                    <input type="file" id="imageInput" accept="image/*" style="display: none;">
                </div>
                
                <div class="image-container" id="imageContainer">
                    <canvas id="imageCanvas"></canvas>
                    <div class="magnifier" id="magnifier">
                        <canvas id="magnifierCanvas"></canvas>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="reset-btn" onclick="resetImage()">
                        <i>üîÑ</i> Reset Image
                    </button>
                    <button class="generate-btn" onclick="generatePalette()">
                        <i>üé®</i> Generate Palette
                    </button>
                </div>
            </div>
            
            <div class="color-info-section">
                <h2><i>üéØ</i> Color Information</h2>
                
                <div class="color-display" id="colorDisplay"></div>
                
                <div class="color-values">
                    <div class="color-value-group">
                        <h3>HEX Color</h3>
                        <div class="color-value">
                            <input type="text" id="hexValue" value="#3498db" readonly>
                            <button onclick="copyToClipboard('hexValue')">Copy</button>
                        </div>
                    </div>
                    
                    <div class="color-value-group">
                        <h3>RGB Color</h3>
                        <div class="color-value">
                            <input type="text" id="rgbValue" value="rgb(52, 152, 219)" readonly>
                            <button onclick="copyToClipboard('rgbValue')">Copy</button>
                        </div>
                    </div>
                    
                    <div class="color-value-group">
                        <h3>HSL Color</h3>
                        <div class="color-value">
                            <input type="text" id="hslValue" value="hsl(204, 70%, 53%)" readonly>
                            <button onclick="copyToClipboard('hslValue')">Copy</button>
                        </div>
                    </div>
                    
                    <div class="color-value-group">
                        <h3>CMYK Color</h3>
                        <div class="color-value">
                            <input type="text" id="cmykValue" value="cmyk(76%, 31%, 0%, 14%)" readonly>
                            <button onclick="copyToClipboard('cmykValue')">Copy</button>
                        </div>
                    </div>
                </div>
                
                <div class="color-palette">
                    <div class="palette-title">Color Palette</div>
                    <div class="palette-colors" id="paletteColors">
                        <!-- Palette colors will be generated here -->
                    </div>
                </div>
                
                <div class="recent-colors">
                    <div class="palette-title">Recent Colors</div>
                    <div class="recent-colors-grid" id="recentColors">
                        <!-- Recent colors will be added here -->
                    </div>
                </div>
            </div>
        </div>
        
        <div class="features">
            <div class="feature-card">
                <i>üéØ</i>
                <h3>Pixel Precision</h3>
                <p>Pick colors with exact pixel accuracy using magnifier tool</p>
            </div>
            <div class="feature-card">
                <i>üé®</i>
                <h3>Multiple Formats</h3>
                <p>Get color values in HEX, RGB, HSL, and CMYK formats</p>
            </div>
            <div class="feature-card">
                <i>üìã</i>
                <h3>Easy Copy</h3>
                <p>Copy color values to clipboard with one click</p>
            </div>
            <div class="feature-card">
                <i>üåà</i>
                <h3>Color Palettes</h3>
                <p>Generate beautiful color palettes from your images</p>
            </div>
        </div>
        
        <footer>
            <p>Color Picker from Image | Part of ToolStackX.io</p>
            <p>¬© 2023 ToolStackX. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const uploadArea = document.getElementById('uploadArea');
        const imageInput = document.getElementById('imageInput');
        const imageContainer = document.getElementById('imageContainer');
        const imageCanvas = document.getElementById('imageCanvas');
        const magnifier = document.getElementById('magnifier');
        const magnifierCanvas = document.getElementById('magnifierCanvas');
        const colorDisplay = document.getElementById('colorDisplay');
        const hexValue = document.getElementById('hexValue');
        const rgbValue = document.getElementById('rgbValue');
        const hslValue = document.getElementById('hslValue');
        const cmykValue = document.getElementById('cmykValue');
        const paletteColors = document.getElementById('paletteColors');
        const recentColors = document.getElementById('recentColors');
        
        // Canvas context
        const ctx = imageCanvas.getContext('2d');
        const magnifierCtx = magnifierCanvas.getContext('2d');
        
        // Variables
        let currentImage = null;
        let recentColorsList = [];
        
        // Event Listeners
        uploadArea.addEventListener('click', () => imageInput.click());
        imageInput.addEventListener('change', handleImageUpload);
        
        // Drag and drop events
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            if (e.dataTransfer.files.length) {
                imageInput.files = e.dataTransfer.files;
                handleImageUpload();
            }
        });
        
        // Canvas click event for color picking
        imageCanvas.addEventListener('click', pickColorFromImage);
        
        // Canvas mouse move for magnifier
        imageCanvas.addEventListener('mousemove', (e) => {
            if (!currentImage) return;
            
            const rect = imageCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Show magnifier
            magnifier.style.display = 'block';
            magnifier.style.left = (x + 20) + 'px';
            magnifier.style.top = (y - 50) + 'px';
            
            // Update magnifier content
            updateMagnifier(x, y);
        });
        
        imageCanvas.addEventListener('mouseleave', () => {
            magnifier.style.display = 'none';
        });
        
        // Handle image upload
        function handleImageUpload() {
            const file = imageInput.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    currentImage = img;
                    
                    // Calculate dimensions to fit in container
                    const maxWidth = imageContainer.clientWidth;
                    const maxHeight = 400;
                    
                    let width = img.width;
                    let height = img.height;
                    
                    if (width > maxWidth) {
                        height = (maxWidth / width) * height;
                        width = maxWidth;
                    }
                    
                    if (height > maxHeight) {
                        width = (maxHeight / height) * width;
                        height = maxHeight;
                    }
                    
                    // Set canvas dimensions
                    imageCanvas.width = width;
                    imageCanvas.height = height;
                    
                    // Draw image on canvas
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // Show image container
                    imageContainer.style.display = 'block';
                    uploadArea.style.display = 'none';
                    
                    // Set magnifier canvas dimensions
                    magnifierCanvas.width = 100;
                    magnifierCanvas.height = 100;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        // Update magnifier
        function updateMagnifier(x, y) {
            const zoom = 4;
            const magnifierSize = 100;
            
            // Clear magnifier
            magnifierCtx.clearRect(0, 0, magnifierSize, magnifierSize);
            
            // Draw zoomed image portion
            magnifierCtx.drawImage(
                imageCanvas,
                x - magnifierSize / (2 * zoom),
                y - magnifierSize / (2 * zoom),
                magnifierSize / zoom,
                magnifierSize / zoom,
                0,
                0,
                magnifierSize,
                magnifierSize
            );
            
            // Draw crosshair
            magnifierCtx.strokeStyle = 'white';
            magnifierCtx.lineWidth = 1;
            magnifierCtx.beginPath();
            magnifierCtx.moveTo(magnifierSize / 2, 0);
            magnifierCtx.lineTo(magnifierSize / 2, magnifierSize);
            magnifierCtx.moveTo(0, magnifierSize / 2);
            magnifierCtx.lineTo(magnifierSize, magnifierSize / 2);
            magnifierCtx.stroke();
        }
        
        // Pick color from image
        function pickColorFromImage(e) {
            if (!currentImage) return;
            
            const rect = imageCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Get pixel data
            const pixel = ctx.getImageData(x, y, 1, 1).data;
            const r = pixel[0];
            const g = pixel[1];
            const b = pixel[2];
            
            // Update color display and values
            updateColorValues(r, g, b);
            
            // Add to recent colors
            addToRecentColors(r, g, b);
        }
        
        // Update color values
        function updateColorValues(r, g, b) {
            // HEX
            const hex = rgbToHex(r, g, b);
            hexValue.value = hex;
            
            // RGB
            rgbValue.value = `rgb(${r}, ${g}, ${b})`;
            
            // HSL
            const hsl = rgbToHsl(r, g, b);
            hslValue.value = `hsl(${Math.round(hsl.h)}, ${Math.round(hsl.s)}%, ${Math.round(hsl.l)}%)`;
            
            // CMYK
            const cmyk = rgbToCmyk(r, g, b);
            cmykValue.value = `cmyk(${Math.round(cmyk.c)}%, ${Math.round(cmyk.m)}%, ${Math.round(cmyk.y)}%, ${Math.round(cmyk.k)}%)`;
            
            // Update color display
            colorDisplay.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
        }
        
        // Add to recent colors
        function addToRecentColors(r, g, b) {
            const hex = rgbToHex(r, g, b);
            
            // Avoid duplicates
            if (!recentColorsList.includes(hex)) {
                recentColorsList.unshift(hex);
                
                // Keep only 12 recent colors
                if (recentColorsList.length > 12) {
                    recentColorsList.pop();
                }
                
                updateRecentColorsDisplay();
            }
        }
        
        // Update recent colors display
        function updateRecentColorsDisplay() {
            recentColors.innerHTML = '';
            
            recentColorsList.forEach(color => {
                const colorElement = document.createElement('div');
                colorElement.className = 'recent-color';
                colorElement.style.backgroundColor = color;
                colorElement.title = color;
                
                colorElement.addEventListener('click', () => {
                    // Convert hex to rgb
                    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(color);
                    if (result) {
                        const r = parseInt(result[1], 16);
                        const g = parseInt(result[2], 16);
                        const b = parseInt(result[3], 16);
                        updateColorValues(r, g, b);
                    }
                });
                
                recentColors.appendChild(colorElement);
            });
        }
        
        // Generate color palette from image
        function generatePalette() {
            if (!currentImage) {
                alert('Please upload an image first');
                return;
            }
            
            // Clear previous palette
            paletteColors.innerHTML = '';
            
            // Sample colors from different areas of the image
            const width = imageCanvas.width;
            const height = imageCanvas.height;
            
            // Sample points (simplified approach)
            const samplePoints = [
                { x: width * 0.2, y: height * 0.2 },
                { x: width * 0.5, y: height * 0.2 },
                { x: width * 0.8, y: height * 0.2 },
                { x: width * 0.2, y: height * 0.5 },
                { x: width * 0.8, y: height * 0.5 },
                { x: width * 0.2, y: height * 0.8 },
                { x: width * 0.5, y: height * 0.8 },
                { x: width * 0.8, y: height * 0.8 }
            ];
            
            samplePoints.forEach(point => {
                const pixel = ctx.getImageData(point.x, point.y, 1, 1).data;
                const r = pixel[0];
                const g = pixel[1];
                const b = pixel[2];
                const hex = rgbToHex(r, g, b);
                
                const colorElement = document.createElement('div');
                colorElement.className = 'palette-color';
                colorElement.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
                
                const hexLabel = document.createElement('span');
                hexLabel.textContent = hex;
                
                colorElement.appendChild(hexLabel);
                
                colorElement.addEventListener('click', () => {
                    updateColorValues(r, g, b);
                });
                
                paletteColors.appendChild(colorElement);
            });
        }
        
        // Reset image
        function resetImage() {
            imageContainer.style.display = 'none';
            uploadArea.style.display = 'block';
            currentImage = null;
            imageInput.value = '';
        }
        
        // Copy to clipboard
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            element.setSelectionRange(0, 99999); // For mobile devices
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    // Show temporary feedback
                    const originalText = element.value;
                    element.value = 'Copied!';
                    setTimeout(() => {
                        element.value = originalText;
                    }, 1000);
                }
            } catch (err) {
                console.error('Failed to copy: ', err);
            }
        }
        
        // Color conversion functions
        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase();
        }
        
        function rgbToHsl(r, g, b) {
            r /= 255;
            g /= 255;
            b /= 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            
            if (max === min) {
                h = s = 0; // achromatic
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                
                h /= 6;
            }
            
            return {
                h: h * 360,
                s: s * 100,
                l: l * 100
            };
        }
        
        function rgbToCmyk(r, g, b) {
            let c = 1 - (r / 255);
            let m = 1 - (g / 255);
            let y = 1 - (b / 255);
            let k = Math.min(c, m, y);
            
            c = (c - k) / (1 - k) || 0;
            m = (m - k) / (1 - k) || 0;
            y = (y - k) / (1 - k) || 0;
            
            return {
                c: c * 100,
                m: m * 100,
                y: y * 100,
                k: k * 100
            };
        }
        
        // Initialize with some recent colors for demonstration
        window.onload = function() {
            const demoColors = [
                '#3498db', '#2ecc71', '#e74c3c', '#f39c12', 
                '#9b59b6', '#1abc9c', '#34495e', '#e67e22'
            ];
            
            demoColors.forEach(color => {
                recentColorsList.push(color);
            });
            
            updateRecentColorsDisplay();
        };
    </script>
</body>
</html>
